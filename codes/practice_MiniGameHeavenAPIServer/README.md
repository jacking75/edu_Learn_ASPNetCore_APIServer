# 미니게임천국 API 서버
- 2023년 신입사원 김성현님 실습  
  
# TODO-LIST

완료한 작업 : ✅

- **하이브 서버 기능**
 
| 기능                                         | 완료 여부 |
| -------------------------------------------- | --------- |
| 하이브 계정생성   						| ✅        |
| [하이브 로그인]							| ✅        |
| [하이브 토큰 검증]								 | ✅        |

- **계정 기능**

| 기능                                         | 완료 여부 |
| -------------------------------------------- | --------- |
| [로그인]						              | ✅        |
| [로그아웃]								       | ✅        |

**데이터 로드**

| 기능                                         | 완료 여부 |
| -------------------------------------------- | --------- |
| [유저 데이터 로드]	                		 | ✅        |
| [게임 데이터 로드]	                		 | ✅        |
| [소셜 데이터 로드]	                		 | ✅        |

- **친구 기능**

| 기능                                            | 완료 여부 |
| ----------------------------------------------- | --------- |
| [친구 목록 조회]								  | ✅        |
| [친구 요청]								  | ✅        |
| [친구 요청 수락]								  | ✅        |
| [친구 삭제]								  | ✅        |
| [친구 요청 취소]								  | ✅        |


- **게임 기능**
 
| 기능                                            | 완료 여부 |
| ----------------------------------------------- | --------- |
| [보유 게임 조회]								  | ✅        |
| [게임 잠금 해제]								  | ✅        |
| [게임별 정보 조회]					          | ✅        |
| [게임 결과 저장]								  | ✅    |
| [게임 대표 캐릭터 설정]                            | ✅        |


- **출석 기능**

| 기능                              | 완료 여부 |
| --------------------------------- | --------- |
| [출석 정보 조회]					| ✅        |
| [출석 체크]						| ✅        |

- **우편 기능**

| 기능                                            | 완료 여부 |
| ----------------------------------------------- | --------- |
| [우편함 조회]									   | ✅        |
| [우편 보상 수령]	                    		   | ✅        |
| [우편 삭제]                                       | ✅        |

- **수령 기능(API가 아닌 서비스 코드)**

출석 체크, 우편 보상 수령 시 사용됨.

| 기능                                            | 완료 여부 |
| ----------------------------------------------- | --------- |
| [일반 보상 수령]								  | ✅        |
| [가챠 보상 수령]								  | ✅        |

**
[가챠] 구현 방식

- **랭킹 기능**

| 기능                                            | 완료 여부 |
| ----------------------------------------------- | --------- |
| [상위 랭킹 조회]								  | ✅        |
| [내 랭킹 조회]									  | ✅        |

- **캐릭터 기능**

| 기능                                            | 완료 여부 |
| ----------------------------------------------- | --------- |
| [캐릭터 목록 조회]								  | ✅        |
| [캐릭터 코스튬 변경]								  | ✅        |

- **사용자 기능**

| 기능                                         | 완료 여부 |
| -------------------------------------------- | --------- |
| [대표 캐릭터 변경]						    | ✅        |
| [다른 사용자 조회]		                        | ✅        |


---

## 가챠
- 가챠는 포함된 아이템들중 하나만을 뽑아내는 것이다.
- 아이템의 종류에 따라 그 확률을 정할 수 있다. (캐릭터 5%, 스킨 1%,...)
- 확률을 통해 타입을 정하고, 그 타입의 아이템들 중 하나를 뽑는 방식으로 구현.

---


## 하이브 로그인

**컨텐츠 설명**
- 하이브에 로그인 하여 고유번호와 토큰을 받습니다.

**로직**
1. 클라이언트가 이메일과 비밀번호를 하이브 서버에 전달한다.
1. 클라이언트의 고유번호와 생성된 토큰을 응답한다. 


클라이언트 → 서버 전송 데이터

| 종류                  | 설명                             |
| --------------------- | -------------------------------- |
| 이메일               | 로그인 이메일 |
| 비밀번호             | 로그인 비밀번호 |


#### 요청 및 응답 예시

- 요청 예시

```
POST http://localhost:11502/LoginHive
Content-Type: application/json

{
    "Email" : "example@test.com",
    "Password" : "Aslj3kldiu!",
}
```

- 응답 예시

```
{
    "result": 0,
    "playerId": 7,
    "hiveToken": "efaee4517404318a8d14f6053767ff74dcf9aw30910b9116dafd3fa4ce408a45"
}
```

---


## 하이브 토큰 검증

**컨텐츠 설명**
- 고유번호와 토큰이 유효한지 확인합니다.

**로직**
1. 클라이언트가 고유번호와 토큰을 전달한다.
1. 고유번호를 토큰화 하여 가지고 있는 토큰과 일치하는지 응답한다.


클라이언트 → 서버 전송 데이터

| 종류                  | 설명                             |
| --------------------- | -------------------------------- |
| 고유번호               | 로그인시 받은 playerId |
| 토큰                  | 로그인시 받은 token |


#### 요청 및 응답 예시

- 요청 예시

```
POST http://localhost:11502/VerifyToken
Content-Type: application/json

{
    "PlayerId" : 58347,
    "Token" : "efaee4517404318a8d14f6053767ff74dcf9aw30910b9116dafd3fa4ce408a45!"
}
```

- 응답 예시

```
{
    "result": 0
}
```

---

## 로그인

**컨텐츠 설명**
- 하이브에서 얻은 고유번호와 토큰을 가지고 게임서버에 로그인 합니다.

**로직**
1. 고유번호와 토큰, 앱 버전, 마스터 데이터 버전을 게임 서버에 전달.
1. [미들웨어] 앱 버전과 마스터 데이터 버전 검증
1. 게임 서버가 고유번호와 토큰을 하이브 서버에 검증.
1. 기존 유저가 아니라면 유저 데이터 생성
1. 게임 서버가 새로운 토큰을 생성 및 Redis 저장 
1. 최근 로그인 시간 갱신
1. 유저 데이터 로드
1. uid, 토큰, 유저데이터 전달

클라이언트 → 서버 전송 데이터
- Header 데이터

| 종류                  | 설명                             |
| --------------------- | -------------------------------- |
| 앱 버전 정보           |     |
| 게임 데이터 정보      |      |

- Body 데이터

| 종류                  | 설명                             |
| --------------------- | -------------------------------- |
| 고유번호               | Hive 로그인시 받은 playerId |
| 토큰                  | Hive 로그인시 받은 token |


#### 요청 및 응답 예시

- 요청 예시

```
POST http://localhost:11500/Login

AppVersion : "0.1",
MasterDataVersion : "0.1"

Content-Type: application/json
{
    "PlayerId" : 58347,
    "Token" : "efaee4517404318a8d14f6053767ff74dcf9aw30910b9116dafd3fa4ce408a45!",
}
```

- 응답 예시
```
{
    "result": 0,
    "token": "6wu4stcad9ibavnva7m5uh9t0",
    "uid": 17,
    "userData": {
        "userInfo": {
            "uid": 17,
            "player_id": "24",
            "nickname": "syaaa1",
            "main_char_key": 1001,
            "create_dt": "2024-01-23T12:15:13",
            "recent_login_dt": "2024-01-23T15:56:39",
            "total_bestscore": 0,
            "total_bestscore_cur_season": 0,
            "total_bestscore_prev_season": 0,
            "star_point": 0
        },
        "moneyInfo": {
            "uid": 17,
            "jewelry": 0,
            "gold_medal": 0,
            "sunchip": 0,
            "cash": 0
        },
        "attendanceInfo": {
            "uid": 17,
            "attendance_cnt": 0,
            "recent_attendance_dt": "2024-01-22T12:15:13"
        }
    }
}
```


---

## 로그아웃

**컨텐츠 설명**
- redis에 저장된 토큰을 지웁니다.

**로직**

1. 유저아이디, 토큰, 앱 버전, 마스터 데이터 버전을 게임 서버에 전달.
1. [미들웨어] 앱 버전과 마스터 데이터 버전 검증
1. [미들웨어] 토큰 검증
1. 게임 서버가 Redis에서 토큰 삭제

클라이언트 → 서버 전송 데이터

- Header 데이터

| 종류                  | 설명                             |
| --------------------- | -------------------------------- |
| 유저아이디               | 게임서버의 uid |
| 토큰                | 레디스에 저장되어 있는 토큰 |
| 앱 버전 정보        |  |
| 게임 데이터 정보     |  |


#### 요청 및 응답 예시

- 요청 예시

```
POST http://localhost:11500/Logout

AppVersion : "0.1",
MasterDataVersion : "0.1"
Uid : 1
Token : "c9v3arfa83vaugm0rxb7txm0c!"

Content-Type: application/json
{
}
```

- 응답 예시

```
{
    "result": 0
}
```

---

## 유저 데이터 로드

**컨텐츠 설명**
- 유저의 정보(점수, 재화, 출석 정보)를 가져옵니다.

**로직**
1. 유저아이디, 토큰, 앱 버전, 마스터 데이터 버전을 게임 서버에 전달.
1. [미들웨어] 앱 버전과 마스터 데이터 버전 검증
1. [미들웨어] 토큰 검증
1. 유저의 정보를 전달

    - 점수 정보
    - 재화 정보
    - 출석 정보

클라이언트 → 서버 전송 데이터
- Header 데이터

| 종류                  | 설명                             |
| --------------------- | -------------------------------- |
| 유저아이디               | 게임서버의 uid |
| 토큰                | 레디스에 저장되어 있는 토큰 |
| 앱 버전 정보        |  |
| 게임 데이터 정보     |  |

#### 요청 및 응답 예시

- 요청 예시

```
POST http://localhost:11500/UserDataLoad

AppVersion : "0.1",
MasterDataVersion : "0.1"
Uid : 1
Token : "c9v3arfa83vaugm0rxb7txm0c!"

Content-Type: application/json
{
}
```

- 응답 예시

```
{
    "userData": {
        "userInfo": {
            "uid": 6,
            "player_id": "18",
            "nickname": "ksy",
            "create_dt": "2024-01-17T14:02:09",
            "recent_login_dt": "2024-01-17T16:21:26",
            "total_bestscore": 0,
            "total_bestscore_cur_season": 0,
            "total_bestscore_prev_season": 0,
            "star_point": 0
        },
        "moneyInfo": {
            "uid": 6,
            "jewelry": 0,
            "gold_medal": 0,
            "sunchip": 0,
            "cash": 0
        },
        "attendanceInfo": {
            "uid": 6,
            "attendance_count": 0,
            "recent_attendance_dt": "0001-01-01T00:00:00"
        }
    },
    "result": 0
}
```

---


## 게임 데이터 로드

**컨텐츠 설명**
- 게임에 필요한 정보(보유한 게임, 캐릭터, 스킨, 코스튬, 푸드)를 가져옵니다.

**로직**
1. 유저아이디, 토큰, 앱 버전, 마스터 데이터 버전을 게임 서버에 전달.
1. [미들웨어] 앱 버전과 마스터 데이터 버전 검증
1. [미들웨어] 토큰 검증
1. 유저의 정보를 전달

    - 게임 정보
    - 캐릭터, 스킨, 코스튬, 푸드 정보

클라이언트 → 서버 전송 데이터
- Header 데이터

| 종류                  | 설명                             |
| --------------------- | -------------------------------- |
| 유저아이디               | 게임서버의 uid |
| 토큰                | 레디스에 저장되어 있는 토큰 |
| 앱 버전 정보        |  |
| 게임 데이터 정보     |  |

#### 요청 및 응답 예시

- 요청 예시

```
POST http://localhost:11500/GameDataLoad

AppVersion : "0.1",
MasterDataVersion : "0.1"
Uid : 1
Token : "c9v3arfa83vaugm0rxb7txm0c!"

Content-Type: application/json
{
}
```

- 응답 예시

```
{
    "gameData": {
        "gameList": [
            {
                "game_key": 1,
                "play_char_key": 1001,
                "bestscore": 0,
                "create_dt": "2024-01-17T14:02:08",
                "new_record_dt": "0001-01-01T00:00:00",
                "recent_play_dt": "0001-01-01T00:00:00",
                "bestscore_cur_season": 0,
                "bestscore_prev_season": 0
            }
        ],
        "charList": [
            {
                "charInfo": {
                    "uid": 6,
                    "char_key": 1,
                    "char_level": 1,
                    "skin_key": 0,
                    "costume_json": null
                },
                "randomSkills": []
            }
        ],
        "skinList": [],
        "costumeList": [],
        "foodList": [],
    },
    "result": 0
}
```

---

## 소셜 데이터 로드

**컨텐츠 설명**
- 소셜 정보(친구 정보, 우편 정보)를 가져옵니다.

**로직**
1. 유저아이디, 토큰, 앱 버전, 마스터 데이터 버전을 게임 서버에 전달.
1. [미들웨어] 앱 버전과 마스터 데이터 버전 검증
1. [미들웨어] 토큰 검증
1. 유저의 정보를 전달

    - 친구 정보
    - 우편 정보

클라이언트 → 서버 전송 데이터
- Header 데이터

| 종류                  | 설명                             |
| --------------------- | -------------------------------- |
| 유저아이디               | 게임서버의 uid |
| 토큰                | 레디스에 저장되어 있는 토큰 |
| 앱 버전 정보        |  |
| 게임 데이터 정보     |  |

#### 요청 및 응답 예시

- 요청 예시

```
POST http://localhost:11500/SocialDataLoad

AppVersion : "0.1",
MasterDataVersion : "0.1"
Uid : 1
Token : "c9v3arfa83vaugm0rxb7txm0c!"

Content-Type: application/json
{
}
```

- 응답 예시

```
{
    "socialData": {
        "friendList": [
            {
                "uid": 13,
                "friend_uid": "17",
                "friend_yn": false,
                "create_dt": "2024-01-23T15:56:27"
            },
            {
                "uid": 17,
                "friend_uid": "8",
                "friend_yn": false,
                "create_dt": "2024-01-23T15:48:29"
            },
            {
                "uid": 17,
                "friend_uid": "14",
                "friend_yn": true,
                "create_dt": "2024-01-23T15:34:53"
            }
        ],
        "mailList": [
            {
                "mailInfo": {
                    "mail_seq": 2,
                    "uid": 8,
                    "mail_title": "두 번째 접속 선물!!!",
                    "create_dt": "2024-01-18T13:58:44",
                    "expire_dt": "2024-02-01T13:58:44",
                    "receive_dt": "2024-01-18T16:21:12"
                },
                "mailItems": [
                    {
                        "mail_seq": 2,
                        "reward_key": 1,
                        "reward_qty": 100,
                        "reward_type": "money"
                    },
                ]
            },
        ],
    },
    "result": 0
}
```

---



## 친구 목록 조회

**컨텐츠 설명**
- 친구 목록, 보낸 요청, 받은 요청 목록을 전달합니다.

**로직**
1. 유저아이디, 토큰, 앱 버전, 마스터 데이터 버전을 게임 서버에 전달.
1. [미들웨어] 앱 버전과 마스터 데이터 버전 검증
1. [미들웨어] 토큰 검증
1. 유저아이디를 통해 친구 목록, 받은 요청, 보낸 요청 목록을 전달합니다.

클라이언트 → 서버 전송 데이터
- Header 데이터

| 종류                  | 설명                             |
| --------------------- | -------------------------------- |
| 유저아이디               | 게임서버의 uid |
| 토큰                | 레디스에 저장되어 있는 토큰 |
| 앱 버전 정보        |  |
| 게임 데이터 정보     |  |

#### 요청 및 응답 예시

- 요청 예시

```
POST http://localhost:11500/FriendList

AppVersion : "0.1",
MasterDataVersion : "0.1"
Uid : 1
Token : "c9v3arfa83vaugm0rxb7txm0c!"

Content-Type: application/json
{
}
```

- 응답 예시

```
{
    "friendList": [
        {
            "uid": 13,
            "friend_uid": "17",
            "friend_yn": false,
            "create_dt": "2024-01-23T15:56:27"
        },
        {
            "uid": 17,
            "friend_uid": "8",
            "friend_yn": false,
            "create_dt": "2024-01-23T15:48:29"
        },
        {
            "uid": 17,
            "friend_uid": "14",
            "friend_yn": true,
            "create_dt": "2024-01-23T15:34:53"
        }
    ],
    "result": 0
}
```

---

## 친구 요청
**컨텐츠 설명**
- 유저 한명에게 친구 요청을 보냅니다.

**로직**
1. 유저아이디, 토큰, 앱 버전, 마스터 데이터 버전, 친구 아이디를 게임 서버에 전달.
1. [미들웨어] 앱 버전과 마스터 데이터 버전 검증
1. [미들웨어] 토큰 검증
1. 해당 유저의 아이디가 없는지 확인
1. 이미 친구신청을 보냈는지 확인
1. 친구 신청 보내기

클라이언트 → 서버 전송 데이터

- Header 데이터

| 종류                  | 설명                             |
| --------------------- | -------------------------------- |
| 유저아이디               | 게임서버의 uid |
| 토큰                | 레디스에 저장되어 있는 토큰 |
| 앱 버전 정보        |  |
| 게임 데이터 정보     |  |

- Body 데이터

| 종류                  | 설명                             |
| --------------------- | -------------------------------- |
| 친구 아이디 | 친구로 등록할 유저의 아이디 |



#### 요청 및 응답 예시

- 요청 예시

```
POST http://localhost:11500/FriendSendReq

AppVersion : "0.1",
MasterDataVersion : "0.1"
Uid : 1
Token : "c9v3arfa83vaugm0rxb7txm0c!"

Content-Type: application/json

{
    "friendId" : 2
}
```

- 응답 예시


```
{
    "result": 0
}
```

---

## 친구 요청 수락
**컨텐츠 설명**
- 받은 친구 요청에 대해 수락합니다.

**로직**
1. 유저아이디, 토큰, 앱 버전, 마스터 데이터 버전, 친구 아이디를 게임 서버에 전달.
1. [미들웨어] 앱 버전과 마스터 데이터 버전 검증
1. [미들웨어] 토큰 검증
1. 해당 유저의 아이디가 없는지 확인
1. 상대가 친구 요청을 보냈는지, 이미 친구인지 확인
1. 친구 요청 수락

클라이언트 → 서버 전송 데이터

- Header 데이터

| 종류                  | 설명                             |
| --------------------- | -------------------------------- |
| 유저아이디               | 게임서버의 uid |
| 토큰                | 레디스에 저장되어 있는 토큰 |
| 앱 버전 정보        |  |
| 게임 데이터 정보     |  |

- Body 데이터

| 종류                  | 설명                             |
| --------------------- | -------------------------------- |
| 친구 아이디 | 친구 요청을 보낸 유저의 아이디 |



#### 요청 및 응답 예시

- 요청 예시

```
POST http://localhost:11500/FriendAccept

AppVersion : "0.1",
MasterDataVersion : "0.1"
Uid : 1
Token : "c9v3arfa83vaugm0rxb7txm0c!"

Content-Type: application/json

{
    "friendId" : 2
}
```

- 응답 예시


```
{
    "result": 0
}
```

---

## 친구 삭제
**컨텐츠 설명**
- 친구를 삭제합니다.

**로직**
1. 유저아이디, 토큰, 앱 버전, 마스터 데이터 버전, 친구 아이디를 게임 서버에 전달.
1. [미들웨어] 앱 버전과 마스터 데이터 버전 검증
1. [미들웨어] 토큰 검증
1. 해당 아이디가 친구인지 확인
1. 양쪽 모두 친구 목록에서 삭제


클라이언트 → 서버 전송 데이터

- Header 데이터

| 종류                  | 설명                             |
| --------------------- | -------------------------------- |
| 유저아이디               | 게임서버의 uid |
| 토큰                | 레디스에 저장되어 있는 토큰 |
| 앱 버전 정보        |  |
| 게임 데이터 정보     |  |

- Body 데이터

| 종류                  | 설명                             |
| --------------------- | -------------------------------- |
| 친구 아이디 | 친구 삭제할 유저의 아이디 |


#### 요청 및 응답 예시

- 요청 예시

```
POST http://localhost:11500/FriendDelete

AppVersion : "0.1",
MasterDataVersion : "0.1"
Uid : 1
Token : "c9v3arfa83vaugm0rxb7txm0c!"

Content-Type: application/json

{
    "friendId" : 2
}
```

- 응답 예시


```
{
    "result": 0
}
```

---

## 친구 요청 취소
**컨텐츠 설명**
- 내가 보낸 친구 요청을 취소합니다.

**로직**
1. 유저아이디, 토큰, 앱 버전, 마스터 데이터 버전, 친구 아이디를 게임 서버에 전달.
1. [미들웨어] 앱 버전과 마스터 데이터 버전 검증
1. [미들웨어] 토큰 검증
1. 해당 친구 요청이 있는지 확인
1. 해당 친구 요청 삭제


클라이언트 → 서버 전송 데이터

- Header 데이터

| 종류                  | 설명                             |
| --------------------- | -------------------------------- |
| 유저아이디               | 게임서버의 uid |
| 토큰                | 레디스에 저장되어 있는 토큰 |
| 앱 버전 정보        |  |
| 게임 데이터 정보     |  |

- Body 데이터

| 종류                  | 설명                             |
| --------------------- | -------------------------------- |
| 친구 아이디 | 친구 요청한 유저의 아이디 |


#### 요청 및 응답 예시

- 요청 예시

```
POST http://localhost:11500/FriendCancelReq

AppVersion : "0.1",
MasterDataVersion : "0.1"
Uid : 1
Token : "c9v3arfa83vaugm0rxb7txm0c!"

Content-Type: application/json

{
    "friendId" : 2
}
```

- 응답 예시


```
{
    "result": 0
}
```

---

## 보유 게임 조회
**컨텐츠 설명**
- 내가 보유한 게임을 조회합니다.

**로직**
1. 유저아이디, 토큰, 앱 버전, 마스터 데이터 버전을 게임 서버에 전달.
1. [미들웨어] 앱 버전과 마스터 데이터 버전 검증
1. [미들웨어] 토큰 검증
1. minigame 테이블에 내 uid를 가진 로우를 조회하여 전달합니다.


클라이언트 → 서버 전송 데이터
- Header 데이터

| 종류                  | 설명                             |
| --------------------- | -------------------------------- |
| 유저아이디               | 게임서버의 uid |
| 토큰                | 레디스에 저장되어 있는 토큰 |
| 앱 버전 정보        | |
| 게임 데이터 정보     |  |


#### 요청 및 응답 예시

- 요청 예시

```
POST http://localhost:11500/MiniGameList

AppVersion : "0.1",
MasterDataVersion : "0.1"
Uid : 1
Token : "c9v3arfa83vaugm0rxb7txm0c!"

Content-Type: application/json

{
}
```

- 응답 예시


```
{
    "miniGameList": [
        {
            "game_key": 1,
            "play_char_key": 1001,
            "bestscore": 0,
            "create_dt": "2024-01-23T12:15:13",
            "new_record_dt": "2024-01-23T12:15:13",
            "recent_play_dt": "2024-01-23T12:15:13",
            "bestscore_cur_season": 0,
            "bestscore_prev_season": 0
        }
    ],
    "result": 0
}
```

---

## 게임 잠금 해제
**컨텐츠 설명**
- 게임을 잠금 해제 합니다.

**로직**
1. 유저아이디, 토큰, 앱 버전, 마스터 데이터 버전, 게임아이디를 게임 서버에 전달.
1. [미들웨어] 앱 버전과 마스터 데이터 버전 검증
1. [미들웨어] 토큰 검증
1. minigame 테이블에 해당 uid 와 game_key로 로우를 생성합니다.


클라이언트 → 서버 전송 데이터
- Header 데이터

| 종류                  | 설명                             |
| --------------------- | -------------------------------- |
| 유저아이디               | 게임서버의 uid |
| 토큰                | 레디스에 저장되어 있는 토큰 |
| 앱 버전 정보        |  |
| 게임 데이터 정보     |  |

- Body 데이터

| 종류                  | 설명                             |
| --------------------- | -------------------------------- |
| 게임 키             | 게임의 고유 키 |

#### 요청 및 응답 예시

- 요청 예시

```
POST http://localhost:11500/MiniGameUnlock

AppVersion : "0.1",
MasterDataVersion : "0.1"
Uid : 1
Token : "c9v3arfa83vaugm0rxb7txm0c!"

Content-Type: application/json

{
    "gameKey": 4
}
```

- 응답 예시


```
{
    "result": 0
}
```

---
## 게임별 정보 조회
**컨텐츠 설명**
- 게임 하나의 정보를 상세 조회합니다.

**로직**
1. 유저아이디, 토큰, 앱 버전, 마스터 데이터 버전, 게임아이디를 게임 서버에 전달.
1. [미들웨어] 앱 버전과 마스터 데이터 버전 검증
1. [미들웨어] 토큰 검증
1. 게임의 정보 (아이템 보유 현황, 플레이 캐릭터(코스튬,스킨)정보, 최고점수, 시즌 최고점수 등)을 조회합니다.
- 현재 아이템 및 캐릭터 정보가 없어 점수만 조회가능.

클라이언트 → 서버 전송 데이터
- Header 데이터

| 종류                  | 설명                             |
| --------------------- | -------------------------------- |
| 유저아이디               | 게임서버의 uid |
| 토큰                | 레디스에 저장되어 있는 토큰 |
| 앱 버전 정보        |  |
| 게임 데이터 정보     |  |

- Body 데이터

| 종류                  | 설명                             |
| --------------------- | -------------------------------- |
| 게임 키             | 게임의 고유 키 |

#### 요청 및 응답 예시

- 요청 예시

```
POST http://localhost:11500/MiniGameInfo

AppVersion : "0.1",
MasterDataVersion : "0.1"
Uid : 1
Token : "c9v3arfa83vaugm0rxb7txm0c!"

Content-Type: application/json

{
    "gameKey": 4
}
```

- 응답 예시


```
{
    "miniGameInfo": {
        "game_key": 3,
        "play_char_key": 1001,
        "bestscore": 0,
        "create_dt": "2024-01-23T12:15:13",
        "new_record_dt": "2024-01-23T12:15:13",
        "recent_play_dt": "2024-01-23T12:15:13",
        "bestscore_cur_season": 0,
        "bestscore_prev_season": 0
    },
    "result": 0
}
```

---

## 게임 결과 저장
**컨텐츠 설명**
- 게임 결과를 저장합니다.

**로직**
1. 유저아이디, 토큰, 앱 버전, 마스터 데이터 버전, 게임아이디 및 결과정보를 게임 서버에 전달.
1. [미들웨어] 앱 버전과 마스터 데이터 버전 검증
1. [미들웨어] 토큰 검증
1. 사용한 아이템 현황, 획득 보상, 점수 등을 업데이트 하고 로그에 기록합니다.
- 현재 아이템과 보상 정보가 없어 점수만 저장 가능

클라이언트 → 서버 전송 데이터
 - Header 데이터

| 종류                  | 설명                             |
| --------------------- | -------------------------------- |
| 유저아이디               | 게임서버의 uid |
| 토큰                | 레디스에 저장되어 있는 토큰 |
| 앱 버전 정보        |  |
| 게임 데이터 정보     |  |

- Body 데이터

| 종류                  | 설명                             |
| --------------------- | -------------------------------- |
| 게임결과 | 사용아이템, 보상, 점수 등 |


#### 요청 및 응답 예시

- 요청 예시

```
POST http://localhost:11500/MiniGameSave
Content-Type: application/json

AppVersion : "0.1",
MasterDataVersion : "0.1"
Uid : 1
Token : "c9v3arfa83vaugm0rxb7txm0c!"

{
    "gameKey": 5,
    "score" : 1000,
    "foods" :[
        {
            "foodKey" : 4001,
            "foodQty" : 7
        }
    ]
}
```

- 응답 예시


```
{
    "result": 0
}
```

---

## 게임 대표 캐릭터 설정
**컨텐츠 설명**
- 게임 대표 캐릭터를 설정합니다.

**로직**
1. 유저아이디, 토큰, 앱 버전, 마스터 데이터 버전, 게임 키, 캐릭터 키를 게임 서버에 전달.
1. [미들웨어] 앱 버전과 마스터 데이터 버전 검증
1. [미들웨어] 토큰 검증
1. 해당 캐릭터를 가지고 있는지 확인합니다.
1. uid와 게임 키로 해당 게임의 캐릭터 키를 바꿉니다.

클라이언트 → 서버 전송 데이터
 - Header 데이터

| 종류                  | 설명                             |
| --------------------- | -------------------------------- |
| 유저아이디               | 게임서버의 uid |
| 토큰                | 레디스에 저장되어 있는 토큰 |
| 앱 버전 정보        |  |
| 게임 데이터 정보     |  |

- Body 데이터

| 종류                  | 설명                             |
| --------------------- | -------------------------------- |
| 게임 키 | gameKey |
| 캐릭터 키 | charKey |


#### 요청 및 응답 예시

- 요청 예시

```
POST http://localhost:11500/MiniGameSetPlayChar
Content-Type: application/json

AppVersion : "0.1",
MasterDataVersion : "0.1"
Uid : 1
Token : "c9v3arfa83vaugm0rxb7txm0c!"

{
    "gameKey": 3,
    "charKey" : 1003
}
```

- 응답 예시


```
{
    "result": 0
}
```

---

## 출석 정보 조회
**컨텐츠 설명**
- 출석 정보를 조회합니다.

**로직**
1. 유저아이디, 토큰, 앱 버전, 마스터 데이터 버전을 게임 서버에 전달.
1. [미들웨어] 앱 버전과 마스터 데이터 버전 검증
1. [미들웨어] 토큰 검증
1. 이번달 출석 횟수와 최근 출석 일시를 조회합니다.

클라이언트 → 서버 전송 데이터
 - Header 데이터

| 종류                  | 설명                             |
| --------------------- | -------------------------------- |
| 유저아이디               | 게임서버의 uid |
| 토큰                | 레디스에 저장되어 있는 토큰 |
| 앱 버전 정보        | |
| 게임 데이터 정보     |  |


#### 요청 및 응답 예시

- 요청 예시

```
POST http://localhost:11500/AttendanceInfo

"uid" : 1,
"Token" : "c9v3arfa83vaugm0rxb7txm0c!",
"AppVersion" : "0.1",
"MasterDataVersion" : "0.1",

Content-Type: application/json
{
}
```

- 응답 예시

```
{
    "attendanceInfo": {
        "uid": 8,
        "attendance_cnt": 10,
        "recent_attendance_dt": "2024-01-18T12:25:03"
    },
    "result": 0
}
```

---

## 출석 체크
**컨텐츠 설명**
- 출석 체크를 합니다.

**로직**
1. 유저아이디, 토큰, 앱 버전, 마스터 데이터 버전을 게임 서버에 전달.
1. [미들웨어] 앱 버전과 마스터 데이터 버전 검증
1. [미들웨어] 토큰 검증
1. 최근 출석일자가 오늘 이전이라면 누적출석일을 1 증가시키고 최근 출석일을 업데이트합니다.
1. 해당 보상을 수령합니다.

클라이언트 → 서버 전송 데이터
 - Header 데이터

| 종류                  | 설명                             |
| --------------------- | -------------------------------- |
| 유저아이디               | 게임서버의 uid |
| 토큰                | 레디스에 저장되어 있는 토큰 |
| 앱 버전 정보        |  |
| 게임 데이터 정보     |  |


#### 요청 및 응답 예시

- 요청 예시

```
Post http://localhost:11500/AttendanceCheck

"uid" : 1,
"Token" : "c9v3arfa83vaugm0rxb7txm0c!",
"AppVersion" : "0.1",
"MasterDataVersion" : "0.1",

Content-Type: application/json
{
}
```

- 응답 예시

```
{
    "rewards": [
        {
            "rewardKey": 5002,
            "rewardDatas": [
                {
                    "reward_key": 4012,
                    "reward_qty": 1,
                    "reward_type": "food"
                },
                {
                    "reward_key": 3002,
                    "reward_qty": 1,
                    "reward_type": "costume"
                },
            ]
        }
    ],
    "result": 0
}
```

---

## 우편함 조회
**컨텐츠 설명**
- 우편함을 조회합니다.

**로직**
1. 유저아이디, 토큰, 앱 버전, 마스터 데이터 버전을 게임 서버에 전달.
1. [미들웨어] 앱 버전과 마스터 데이터 버전 검증
1. [미들웨어] 토큰 검증
1. 우편의 내용과 보상정보를 조회합니다.

클라이언트 → 서버 전송 데이터
 - Header 데이터

| 종류                  | 설명                             |
| --------------------- | -------------------------------- |
| 유저아이디               | 게임서버의 uid |
| 토큰                | 레디스에 저장되어 있는 토큰 |
| 앱 버전 정보        | |
| 게임 데이터 정보     |  |


#### 요청 및 응답 예시

- 요청 예시

```
POST http://localhost:11500/MailList

"uid" : 1,
"Token" : "c9v3arfa83vaugm0rxb7txm0c!",
"AppVersion" : "0.1",
"MasterDataVersion" : "0.1",

Content-Type: application/json
{
}
```

- 응답 예시

```
{
    "mailList": [
        {
            "mailInfo": {
                "mail_seq": 2,
                "uid": 8,
                "mail_title": "두 번째 접속 선물!!!",
                "create_dt": "2024-01-18T13:58:44",
                "expire_dt": "2024-02-01T13:58:44",
                "receive_dt": "2024-01-18T16:21:12"
            },
            "mailItems": [
                {
                    "mail_seq": 2,
                    "reward_key": 1,
                    "reward_qty": 100,
                    "reward_type": "money"
                },
            ]
        },
    ],
    "result": 0
}
```

---


## 우편 보상 수령
**컨텐츠 설명**
- 우편의 보상을 수령합니다.

**로직**
1. 유저아이디, 토큰, 앱 버전, 마스터 데이터 버전, 우편의 번호를 게임 서버에 전달.
1. [미들웨어] 앱 버전과 마스터 데이터 버전 검증
1. [미들웨어] 토큰 검증
1. 유저가 우편의 주인인지 확인하고, 우편의 보상들을 수령하고, 수령일자를 저장합니다.

클라이언트 → 서버 전송 데이터
 - Header 데이터

| 종류                  | 설명                             |
| --------------------- | -------------------------------- |
| 유저아이디               | 게임서버의 uid |
| 토큰                | 레디스에 저장되어 있는 토큰 |
| 앱 버전 정보        | |
| 게임 데이터 정보     |  |

- Body 데이터
| 종류                  | 설명                             |
| --------------------- | -------------------------------- |
| 우편의 번호            | MailSeq |

#### 요청 및 응답 예시

- 요청 예시

```
POST http://localhost:11500/MailReceive

"uid" : 1,
"Token" : "c9v3arfa83vaugm0rxb7txm0c!",
"AppVersion" : "0.1",
"MasterDataVersion" : "0.1",

Content-Type: application/json
{
    "MailSeq" : 1
}
```

- 응답 예시

```
{
    "rewards": [
        {
            "rewardKey": 1,
            "rewardDatas": [
                {
                    "reward_key": 1,
                    "reward_qty": 100,
                    "reward_type": "money"
                }
            ]
        },
        {
            "rewardKey": 1001,
            "rewardDatas": [
                {
                    "reward_key": 1001,
                    "reward_qty": 1,
                    "reward_type": "char"
                }
            ]
        },
        {
            "rewardKey": 5001,
            "rewardDatas": [
                {
                    "reward_key": 3004,
                    "reward_qty": 1,
                    "reward_type": "costume"
                },
                {
                    "reward_key": 4002,
                    "reward_qty": 1,
                    "reward_type": "food"
                },
                {
                    "reward_key": 4009,
                    "reward_qty": 1,
                    "reward_type": "food"
                }
            ]
        }
    ],
    "result": 0
}
```

---

## 우편 삭제
**컨텐츠 설명**
- 우편을 삭제합니다.

**로직**
1. 유저아이디, 토큰, 앱 버전, 마스터 데이터 버전, 우편의 번호를 게임 서버에 전달.
1. [미들웨어] 앱 버전과 마스터 데이터 버전 검증
1. [미들웨어] 토큰 검증
1. 유저가 우편의 주인인지 확인하고, 우편의 번호를 통해 우편을 삭제합니다.

클라이언트 → 서버 전송 데이터
 - Header 데이터

| 종류                  | 설명                             |
| --------------------- | -------------------------------- |
| 유저아이디               | 게임서버의 uid |
| 토큰                | 레디스에 저장되어 있는 토큰 |
| 앱 버전 정보        | |
| 게임 데이터 정보     |  |

- Body 데이터
| 종류                  | 설명                             |
| --------------------- | -------------------------------- |
| 우편의 번호            | MailSeq |

#### 요청 및 응답 예시

- 요청 예시

```
POST http://localhost:11500/MailDelete

"uid" : 1,
"Token" : "c9v3arfa83vaugm0rxb7txm0c!",
"AppVersion" : "0.1",
"MasterDataVersion" : "0.1",

Content-Type: application/json
{
    "MailSeq" : 1
}
```

- 응답 예시

```
{
    "result": 0
}
```

---

## 일반 보상 수령
(서비스 코드)
**컨텐츠 설명**
- 일반 보상을 수령합니다.

**로직**
1. 보상 키, 보상 수, 보상 종류를 입력받습니다.
1. 보상 종류를 통해 해당 메서드를 호출하여 보상 수만큼 보상을 지급합니다.

## 가챠 보상 수령
(서비스 코드)
**컨텐츠 설명**
- 가챠 보상을 수령합니다.

**로직**
1. 가챠 보상 키로 마스터 데이터에서 보상의 정보를 가져옵니다.
1. 일반 보상 종류(캐릭터, 스킨, 코스튬, 푸드, 푸드기어)에 따른 확률을 통해 랜덤하게 종류를 선택합니다.
1. 해당 타입의 가챠 보상들 중 하나를 랜덤하게 선택합니다.
1. 선택된 보상을 일반 보상 수령을 통해 지급합니다.
1. 위 과정을 가챠 횟수 만큼 반복합니다.
1. 지급된 보상들을 반환합니다.

## 상위 랭킹 조회
**컨텐츠 설명**
- 상위 100명의 랭킹을 조회합니다.

**로직**
1. 유저아이디, 토큰, 앱 버전, 마스터 데이터 버전을 게임 서버에 전달.
1. [미들웨어] 앱 버전과 마스터 데이터 버전 검증
1. [미들웨어] 토큰 검증
1. 유저의 최고점수를 기준으로 상위 100명의 순위, uid, 점수를 반환합니다.

클라이언트 → 서버 전송 데이터
 - Header 데이터

| 종류                  | 설명                             |
| --------------------- | -------------------------------- |
| 유저아이디               | 게임서버의 uid |
| 토큰                | 레디스에 저장되어 있는 토큰 |
| 앱 버전 정보        | |
| 게임 데이터 정보     |  |

#### 요청 및 응답 예시

- 요청 예시

```
POST http://localhost:11500/TopRanking

"uid" : 1,
"Token" : "c9v3arfa83vaugm0rxb7txm0c!",
"AppVersion" : "0.1",
"MasterDataVersion" : "0.1",

Content-Type: application/json
{
}
```

- 응답 예시

```
{
    "rankingData": [
        {
            "rank": 1,
            "uid": 9,
            "score": 10000
        },
        {
            "rank": 2,
            "uid": 8,
            "score": 1000
        },
        {
            "rank": 2,
            "uid": 7,
            "score": 1000
        }
    ],
    "result": 0
}
```

---

## 내 랭킹 조회
**컨텐츠 설명**
- 내 등수를 조회합니다.

**로직**
1. 유저아이디, 토큰, 앱 버전, 마스터 데이터 버전을 게임 서버에 전달.
1. [미들웨어] 앱 버전과 마스터 데이터 버전 검증
1. [미들웨어] 토큰 검증
1. 내 uid로 랭킹에서 등수를 조회합니다.

클라이언트 → 서버 전송 데이터
 - Header 데이터

| 종류                  | 설명                             |
| --------------------- | -------------------------------- |
| 유저아이디               | 게임서버의 uid |
| 토큰                | 레디스에 저장되어 있는 토큰 |
| 앱 버전 정보        | |
| 게임 데이터 정보     |  |

#### 요청 및 응답 예시

- 요청 예시

```
POST http://localhost:11500/UserRank

"uid" : 1,
"Token" : "c9v3arfa83vaugm0rxb7txm0c!",
"AppVersion" : "0.1",
"MasterDataVersion" : "0.1",

Content-Type: application/json
{
}
```

- 응답 예시

```
{
    "rank": 2,
    "result": 0
}
```

---

## 캐릭터 목록 조회
**컨텐츠 설명**
- 보유한 캐릭터 목록을 조회합니다.

**로직**
1. 유저아이디, 토큰, 앱 버전, 마스터 데이터 버전을 게임 서버에 전달.
1. [미들웨어] 앱 버전과 마스터 데이터 버전 검증
1. [미들웨어] 토큰 검증
1. 유저가 보유한 캐릭터들의 정보를 반환합니다.

클라이언트 → 서버 전송 데이터
 - Header 데이터

| 종류                  | 설명                             |
| --------------------- | -------------------------------- |
| 유저아이디               | 게임서버의 uid |
| 토큰                | 레디스에 저장되어 있는 토큰 |
| 앱 버전 정보        | |
| 게임 데이터 정보     |  |

#### 요청 및 응답 예시

- 요청 예시

```
POST http://localhost:11500/CharacterList

"uid" : 1,
"Token" : "c9v3arfa83vaugm0rxb7txm0c!",
"AppVersion" : "0.1",
"MasterDataVersion" : "0.1",

Content-Type: application/json
{
}
```

- 응답 예시

```
{
    "charList": [
        {
            "charInfo": {
                "uid": 9,
                "char_key": 1001,
                "char_level": 1,
                "char_cnt": 1,
                "skin_key": 0,
                "costume_json": "{\"face\": 3007, \"hand\": 3009, \"head\": 0}"
            },
            "randomSkills": []
        },
        {
            "charInfo": {
                "uid": 9,
                "char_key": 1003,
                "char_level": 1,
                "char_cnt": 1,
                "skin_key": 0,
                "costume_json": null
            },
            "randomSkills": []
        }
    ],
    "result": 0
}
```

---

## 캐릭터 코스튬 변경
**컨텐츠 설명**
- 캐릭터의 코스튬을 변경합니다.

**로직**
1. 유저아이디, 토큰, 앱 버전, 마스터 데이터 버전, 캐릭터 키, 코스튬 정보를 게임 서버에 전달.
1. [미들웨어] 앱 버전과 마스터 데이터 버전 검증
1. [미들웨어] 토큰 검증
1. 머리, 얼굴, 손 코스튬의 모든 정보를 받아 유저가 보유한 코스튬인지 확인합니다.(단, 미착용 key 는 0)
1. 해당 코스튬을 저장합니다.

클라이언트 → 서버 전송 데이터
 - Header 데이터

| 종류                  | 설명                             |
| --------------------- | -------------------------------- |
| 유저아이디               | 게임서버의 uid |
| 토큰                | 레디스에 저장되어 있는 토큰 |
| 앱 버전 정보        | |
| 게임 데이터 정보     |  |

 - Body 데이터

| 종류                  | 설명                             |
| --------------------- | -------------------------------- |
| 캐릭터 키               | 캐릭터의 고유번호 |
| 코스튬 정보                | 머리, 얼굴, 손의 코스튬 키 정보 |

#### 요청 및 응답 예시

- 요청 예시

```
POST http://localhost:11500/CharacterSetCostume

"uid" : 1,
"Token" : "c9v3arfa83vaugm0rxb7txm0c!",
"AppVersion" : "0.1",
"MasterDataVersion" : "0.1",

Content-Type: application/json
{
    "charKey":"1001",
    "costumeInfo":{
        "Head":0,
        "Face":3007,
        "Hand":3009
    }
}
```

- 응답 예시

```
{
    "result": 0
}
```

---

## 대표 캐릭터 변경
**컨텐츠 설명**
- 유저의 대표 캐릭터를 변경합니다.

**로직**
1. 유저아이디, 토큰, 앱 버전, 마스터 데이터 버전, 캐릭터 키를 게임 서버에 전달.
1. [미들웨어] 앱 버전과 마스터 데이터 버전 검증
1. [미들웨어] 토큰 검증
1. 캐릭터 키를 통해 유저가 보유한 캐릭터인지 확인합니다.
1. 대표 캐릭터를 변경합니다.

클라이언트 → 서버 전송 데이터
 - Header 데이터

| 종류                  | 설명                             |
| --------------------- | -------------------------------- |
| 유저아이디               | 게임서버의 uid |
| 토큰                | 레디스에 저장되어 있는 토큰 |
| 앱 버전 정보        | |
| 게임 데이터 정보     |  |

 - Body 데이터

| 종류                  | 설명                             |
| --------------------- | -------------------------------- |
| 캐릭터 키               | 캐릭터의 고유번호 |

#### 요청 및 응답 예시

- 요청 예시

```
POST http://localhost:11500/UserSetMainChar

"uid" : 1,
"Token" : "c9v3arfa83vaugm0rxb7txm0c!",
"AppVersion" : "0.1",
"MasterDataVersion" : "0.1",

Content-Type: application/json
{
    "charKey":"1001",
}
```

- 응답 예시

```
{
    "result": 0
}
```

---

## 다른 사용자 조회
**컨텐츠 설명**
- 다른 사용자의 기본 정보를 조회합니다.

**로직**
1. 유저아이디, 토큰, 앱 버전, 마스터 데이터 버전, 유저아이디를 게임 서버에 전달.
1. [미들웨어] 앱 버전과 마스터 데이터 버전 검증
1. [미들웨어] 토큰 검증
1. uid를 통해 있는 사용자인지 확인합니다.
1. 사용자의 정보를 전달합니다.
   - uid
   - 닉네임
   - 최고 점수 정보
   - 메인 캐릭터 정보(스킨, 코스튬)
   - 등수


클라이언트 → 서버 전송 데이터
 - Header 데이터

| 종류                  | 설명                             |
| --------------------- | -------------------------------- |
| 유저아이디               | 게임서버의 uid |
| 토큰                | 레디스에 저장되어 있는 토큰 |
| 앱 버전 정보        | |
| 게임 데이터 정보     |  |

 - Body 데이터

| 종류                  | 설명                             |
| --------------------- | -------------------------------- |
| 유저아이디               | uid |

#### 요청 및 응답 예시

- 요청 예시

```
POST http://localhost:11500/OtherUserInfo

"uid" : 1,
"Token" : "c9v3arfa83vaugm0rxb7txm0c!",
"AppVersion" : "0.1",
"MasterDataVersion" : "0.1",

Content-Type: application/json
{
    "uid" : 14
}
```

- 응답 예시

```
{
    "userInfo": {
        "uid": 14,
        "nickname": "syaa1",
        "total_bestscore": 0,
        "total_bestscore_cur_season": 0,
        "total_bestscore_prev_season": 0,
        "main_char_key": 1001,
        "main_char_skin_key": 0,
        "main_char_costume_json": "{\"face\": 0, \"hand\": 0, \"head\": 0}"
    },
    "result": 0
}
```

---